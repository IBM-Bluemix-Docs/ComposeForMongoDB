---
copyright:
  years: 2016,2018
lastupdated: "2018-06-11"
---

{:new_window: target="_blank"}
{:shortdesc: .shortdesc}
{:screen: .screen}
{:codeblock: .codeblock}
{:pre: .pre}
{:tip: .tip}

# 体系结构 
{: #architecture}

## 复制

{{site.data.keyword.composeForMongoDB_full}} 服务随附配置为单分片的三数据节点副本集。您可选择部署了该服务的区域，三个数据节点会分布在该区域的可用性专区中，然后数据会在所有三个数据节点之间进行复制。MongoDB 将所有写操作推送到主数据节点，然后（通过 oplog）将其传播到分片上的辅助数据节点。如果主节点发生故障，那么辅助节点将升级为主节点。如果任何一个数据成员变为不可访问，MongoDB 分片仍会继续正常运行。

## 磁盘加密

所有 {{site.data.keyword.composeForMongoDB}} 服务都具有静态加密。数据位于启用了卷级别加密的服务器上。 

由于 {{site.data.keyword.composeForMongoDB}} 是受管服务，因此 {{site.data.keyword.cloud}} Compose 操作员可以查看数据。除了磁盘加密外，还建议您在数据库中存储个人信息之前，对这些信息加密，或者使用扩展或功能启用对数据库本身的加密。虽然这些方法可能会影响可用性或性能，但确保个人信息受到加密保护是比较好的做法。

## 自动扩展

资源将根据 MongoDB 数据库的磁盘存储总使用量自动进行扩展。内存基于按 1:4 比率供应的磁盘。这些资源会捆绑为单元。

自动扩展旨在响应数据库的中短期趋势。系统每小时会检查一次服务，如果服务的磁盘空间不足，那么会向部署分配更多单元。 

自动扩展不会向下扩展部署，即减少磁盘/内存使用量。向数据库供应的资源将保留以满足您的未来需求，或者直到您手动向下扩展部署为止。
{: .tip}

## 管理数据库

如果在管理数据库中存储数据，那么此数据库将无法正常执行，并且数据存在丢失风险。

与其他 MongoDB 安装一样，{{site.data.keyword.composeForMongoDB}} 也具有一个管理数据库。管理数据库保存有关数据库中用户和角色以及各种跟踪集合的信息。在简单 MongoDB 安装中，这些信息与其他数据一起存储在该数据库中。 

在 {{site.data.keyword.composeForMongoDB}} 上，使用 MongoDB 分片体系结构可实现更具弹性的体系结构。这涉及在分片之间共享管理数据，可通过创建包含管理数据库的另一数据库集群来实现。

此集群的管理数据库并非为扩展而构建，它会随其中存储的数据量的增加而快速降级。因此，必须确保应用程序不会将数据写入该管理数据库。
